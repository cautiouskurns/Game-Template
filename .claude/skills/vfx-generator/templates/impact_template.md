# Impact/Burst Template

## Pattern Description
One-shot burst effect that plays on hit/collision, includes camera shake, and auto-destroys.

## Scene Structure
```
Node2D (Root) - "[ImpactName]"
├── GPUParticles2D - "Burst"
│   └── [Particle burst - one shot, explosive spread]
├── ColorRect - "Flash"
│   └── [Scales up and fades out]
├── PointLight2D - "LightBurst"
│   └── [Bright flash that fades]
└── AudioStreamPlayer2D - "ImpactSound" (optional)
```

## Complete .tscn Template

```
[gd_scene load_steps=4 format=3 uid="uid://impact_template"]

[ext_resource type="Script" path="res://vfx/impacts/SCRIPT_NAME.gd" id="1_script"]

[sub_resource type="ParticleProcessMaterial" id="ParticleProcessMaterial_burst"]
emission_shape = 1
emission_sphere_radius = 4.0
particle_flag_disable_z = true
direction = Vector3(0, 0, 0)
spread = 180.0
gravity = Vector3(0, 100, 0)
initial_velocity_min = 100.0
initial_velocity_max = 200.0
damping_min = 2.0
damping_max = 4.0
scale_min = 0.5
scale_max = 1.5
color = Color(PRIMARY_COLOR)

[sub_resource type="Gradient" id="Gradient_fade"]
offsets = PackedFloat32Array(0, 0.3, 1)
colors = PackedColorArray(1, 1, 1, 1, 1, 1, 1, 0.8, 1, 1, 1, 0)

[sub_resource type="GradientTexture1D" id="GradientTexture1D_fade"]
gradient = SubResource("Gradient_fade")

[node name="EFFECT_NAME" type="Node2D"]
script = ExtResource("1_script")

[node name="Burst" type="GPUParticles2D" parent="."]
amount = 30
process_material = SubResource("ParticleProcessMaterial_burst")
lifetime = 0.4
one_shot = true
explosiveness = 1.0

[node name="Flash" type="ColorRect" parent="."]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -16.0
offset_top = -16.0
offset_right = 16.0
offset_bottom = 16.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(16, 16)
color = Color(FLASH_COLOR)

[node name="LightBurst" type="PointLight2D" parent="."]
color = Color(GLOW_COLOR)
energy = 2.0
texture_scale = 2.0
```

## Complete Script Template

```gdscript
## [EFFECT_NAME] - Impact/Burst VFX
## Generated by VFX Generator skill
## Type: Impact
extends Node2D

# ===== EXPORTED PROPERTIES =====
@export var particle_count: int = 30
@export var burst_color: Color = Color("PRIMARY_COLOR")
@export var flash_color: Color = Color("FLASH_COLOR")
@export var glow_color: Color = Color("GLOW_COLOR")
@export var shake_intensity: float = 10.0
@export var duration: float = 0.4

# ===== NODE REFERENCES =====
@onready var burst: GPUParticles2D = $Burst
@onready var flash: ColorRect = $Flash
@onready var light_burst: PointLight2D = $LightBurst

# ===== LIFECYCLE =====
func _ready() -> void:
	_apply_colors()
	_play_effect()

func _apply_colors() -> void:
	# Apply burst color
	var burst_mat = burst.process_material as ParticleProcessMaterial
	if burst_mat:
		burst_mat.color = burst_color

	flash.color = flash_color
	light_burst.color = glow_color

func _play_effect() -> void:
	# Play sound if available
	if has_node("ImpactSound"):
		$ImpactSound.play()

	# Trigger camera shake
	_shake_camera()

	# Animate flash (scale up and fade)
	var tween = create_tween()
	tween.set_parallel(true)

	# Flash scales up
	flash.scale = Vector2(0.5, 0.5)
	tween.tween_property(flash, "scale", Vector2(2.0, 2.0), duration * 0.3)

	# Flash fades out
	tween.tween_property(flash, "modulate:a", 0.0, duration * 0.5)

	# Light burst fades
	tween.tween_property(light_burst, "energy", 0.0, duration * 0.6)

	# Ensure burst plays
	burst.emitting = true

	# Auto-destroy after effect completes
	await get_tree().create_timer(duration + 0.1).timeout
	queue_free()

func _shake_camera() -> void:
	var camera = get_viewport().get_camera_2d()
	if camera and camera.has_method("shake"):
		camera.shake(shake_intensity)
	else:
		# Fallback: simple offset shake
		_simple_shake()

func _simple_shake() -> void:
	var original_offset = Vector2.ZERO
	var camera = get_viewport().get_camera_2d()
	if not camera:
		return

	original_offset = camera.offset

	var tween = create_tween()
	for i in range(5):
		var offset = Vector2(
			randf_range(-shake_intensity, shake_intensity),
			randf_range(-shake_intensity, shake_intensity)
		)
		tween.tween_property(camera, "offset", original_offset + offset, 0.05)

	tween.tween_property(camera, "offset", original_offset, 0.1)
```

## Usage Example

```gdscript
# Spawn an impact effect
func spawn_explosion(at_position: Vector2) -> void:
	var explosion = preload("res://vfx/impacts/EFFECT_NAME.tscn").instantiate()
	get_tree().current_scene.add_child(explosion)
	explosion.global_position = at_position

# With custom settings
func spawn_big_explosion(at_position: Vector2) -> void:
	var explosion = preload("res://vfx/impacts/EFFECT_NAME.tscn").instantiate()
	get_tree().current_scene.add_child(explosion)
	explosion.global_position = at_position
	explosion.shake_intensity = 20.0
	explosion.particle_count = 50
```

## Variants

### Directional Burst
For hits that should spray in a direction:
```gdscript
@export var burst_direction: Vector2 = Vector2.UP

func _apply_colors() -> void:
	var burst_mat = burst.process_material as ParticleProcessMaterial
	if burst_mat:
		burst_mat.direction = Vector3(burst_direction.x, burst_direction.y, 0)
		burst_mat.spread = 45.0  # Narrower cone
```

### Ring Burst
Particles expand in a ring:
```gdscript
func _ready() -> void:
	var burst_mat = burst.process_material as ParticleProcessMaterial
	if burst_mat:
		burst_mat.emission_shape = ParticleProcessMaterial.EMISSION_SHAPE_RING
		burst_mat.emission_ring_radius = 16.0
		burst_mat.emission_ring_inner_radius = 12.0
		burst_mat.gravity = Vector3.ZERO
```

### Shatter Effect
Multiple small fragments:
```gdscript
func _play_effect() -> void:
	# Create shard fragments
	for i in range(8):
		var shard = ColorRect.new()
		shard.size = Vector2(4, 8)
		shard.color = burst_color
		shard.pivot_offset = shard.size / 2
		add_child(shard)

		var angle = (TAU / 8) * i
		var dir = Vector2.from_angle(angle)

		var tween = create_tween()
		tween.set_parallel(true)
		tween.tween_property(shard, "position", dir * 50, 0.3)
		tween.tween_property(shard, "rotation", randf_range(-PI, PI), 0.3)
		tween.tween_property(shard, "modulate:a", 0.0, 0.3)

	# ... rest of effect
```

## Element Color Presets

| Element | Primary (Burst) | Flash | Glow |
|---------|-----------------|-------|------|
| Fire | `#ff6b35` | `#ffdc00` | `#ff8c42` |
| Ice | `#3b82f6` | `#e0f2fe` | `#60a5fa` |
| Poison | `#22c55e` | `#dcfce7` | `#4ade80` |
| Lightning | `#38bdf8` | `#ffffff` | `#7dd3fc` |
| Holy | `#fbbf24` | `#ffffff` | `#fcd34d` |
| Dark | `#7c3aed` | `#1e1b4b` | `#a78bfa` |
| Physical | `#d4d4d4` | `#ffffff` | `#e5e5e5` |

## Shake Intensity Guide

| Impact Type | Shake Amount |
|-------------|--------------|
| Small hit | 2-4 |
| Medium hit | 5-8 |
| Large hit | 10-15 |
| Explosion | 15-25 |
| Critical hit | 12-18 |
| Boss attack | 20-30 |
