# UI Number Template

## Pattern Description
Floating number that pops up to show damage, healing, or other values. Floats upward, scales for emphasis, then fades out.

## Scene Structure
```
Label (Root) - "[NumberType]"
└── [Script handles all animation - no child nodes needed]
```

This is the simplest template - just a Label with a script that handles everything.

## Complete .tscn Template

```
[gd_scene load_steps=3 format=3 uid="uid://ui_number_template"]

[ext_resource type="Script" path="res://vfx/ui/SCRIPT_NAME.gd" id="1_script"]

[sub_resource type="LabelSettings" id="LabelSettings_number"]
font_size = 20
outline_size = 2
outline_color = Color(0, 0, 0, 1)

[node name="EFFECT_NAME" type="Label"]
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -50.0
offset_top = -15.0
offset_right = 50.0
offset_bottom = 15.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(50, 15)
text = "999"
label_settings = SubResource("LabelSettings_number")
horizontal_alignment = 1
vertical_alignment = 1
script = ExtResource("1_script")
```

## Complete Script Template

```gdscript
## [EFFECT_NAME] - UI Number VFX
## Generated by VFX Generator skill
## Type: UI Number
extends Label

# ===== EXPORTED PROPERTIES =====
@export var float_distance: float = 50.0
@export var float_duration: float = 1.0
@export var horizontal_spread: float = 20.0
@export var scale_peak: float = 1.3
@export var scale_time: float = 0.15
@export var default_color: Color = Color.RED
@export var crit_scale_multiplier: float = 1.5
@export var crit_prefix: String = "CRIT! "

# ===== LIFECYCLE =====
func _ready() -> void:
	# Random horizontal offset for variety
	position.x += randf_range(-horizontal_spread, horizontal_spread)

	# Start animation
	_play_animation()

func _play_animation() -> void:
	var tween = create_tween()
	tween.set_parallel(true)

	# Float upward
	tween.tween_property(
		self,
		"position:y",
		position.y - float_distance,
		float_duration
	).set_ease(Tween.EASE_OUT)

	# Scale pop: grow then shrink
	tween.tween_property(
		self,
		"scale",
		Vector2(scale_peak, scale_peak),
		scale_time
	).set_ease(Tween.EASE_OUT)

	# After peak, shrink back
	tween.chain().tween_property(
		self,
		"scale",
		Vector2(0.8, 0.8),
		float_duration - scale_time
	).set_ease(Tween.EASE_IN)

	# Fade out in second half
	tween.tween_property(
		self,
		"modulate:a",
		0.0,
		float_duration * 0.6
	).set_delay(float_duration * 0.4).set_ease(Tween.EASE_IN)

	# Destroy when done
	await tween.finished
	queue_free()

# ===== PUBLIC API =====
func set_number(value: int, color: Color = Color.RED) -> void:
	## Set the number value and color
	text = str(value)
	modulate = color

func set_damage(value: int, is_crit: bool = false) -> void:
	## Set as damage number (red by default)
	if is_crit:
		text = crit_prefix + str(value)
		scale = Vector2(crit_scale_multiplier, crit_scale_multiplier)
		modulate = Color.YELLOW
	else:
		text = str(value)
		modulate = Color.RED

func set_heal(value: int) -> void:
	## Set as healing number (green)
	text = "+" + str(value)
	modulate = Color.GREEN

func set_text_value(value: String, color: Color = Color.WHITE) -> void:
	## Set custom text (for "MISS", "BLOCKED", etc.)
	text = value
	modulate = color

func set_gold(value: int) -> void:
	## Set as gold gain (yellow/gold)
	text = "+" + str(value) + " gold"
	modulate = Color.GOLD

func set_xp(value: int) -> void:
	## Set as XP gain (purple)
	text = "+" + str(value) + " XP"
	modulate = Color.MEDIUM_PURPLE
```

## Usage Example

```gdscript
# Spawn a damage number
func show_damage(target: Node2D, amount: int, is_crit: bool = false) -> void:
	var dmg_num = preload("res://vfx/ui/damage_number.tscn").instantiate()
	get_tree().current_scene.add_child(dmg_num)

	dmg_num.global_position = target.global_position + Vector2(0, -40)
	dmg_num.set_damage(amount, is_crit)

# Spawn a heal number
func show_heal(target: Node2D, amount: int) -> void:
	var heal_num = preload("res://vfx/ui/heal_number.tscn").instantiate()
	get_tree().current_scene.add_child(heal_num)

	heal_num.global_position = target.global_position + Vector2(0, -40)
	heal_num.set_heal(amount)

# Show "MISS" text
func show_miss(target: Node2D) -> void:
	var miss_num = preload("res://vfx/ui/damage_number.tscn").instantiate()
	get_tree().current_scene.add_child(miss_num)

	miss_num.global_position = target.global_position + Vector2(0, -40)
	miss_num.set_text_value("MISS", Color.GRAY)
```

## Variants

### Stacking Numbers (Multiple Hits)
```gdscript
# Pool and combine rapid hits
var pending_damage: int = 0
var pending_timer: float = 0.0
const STACK_WINDOW: float = 0.1

func add_damage(amount: int) -> void:
	pending_damage += amount
	pending_timer = STACK_WINDOW

func _process(delta: float) -> void:
	if pending_damage > 0:
		pending_timer -= delta
		if pending_timer <= 0:
			show_damage(pending_damage)
			pending_damage = 0
```

### Bouncing Number
```gdscript
func _play_animation() -> void:
	var tween = create_tween()

	# Bounce up and down
	tween.tween_property(self, "position:y", position.y - 30, 0.2).set_ease(Tween.EASE_OUT)
	tween.tween_property(self, "position:y", position.y - 10, 0.15).set_ease(Tween.EASE_IN)
	tween.tween_property(self, "position:y", position.y - 20, 0.1).set_ease(Tween.EASE_OUT)
	tween.tween_property(self, "position:y", position.y - 15, 0.1).set_ease(Tween.EASE_IN)

	# Fade out
	tween.parallel().tween_property(self, "modulate:a", 0.0, 0.8).set_delay(0.3)

	await tween.finished
	queue_free()
```

### Spiral Float
```gdscript
var _angle: float = 0.0
var _elapsed: float = 0.0
var _start_pos: Vector2

func _ready() -> void:
	_start_pos = position
	_angle = randf() * TAU

func _process(delta: float) -> void:
	_elapsed += delta
	_angle += delta * 5  # Rotation speed

	var radius = 10 * (1 - _elapsed / float_duration)
	var offset = Vector2(cos(_angle), sin(_angle)) * radius

	position = _start_pos + offset + Vector2(0, -float_distance * (_elapsed / float_duration))
	modulate.a = 1.0 - (_elapsed / float_duration)

	if _elapsed >= float_duration:
		queue_free()
```

### Rising Text with Trail
```gdscript
var _trail_nodes: Array[Label] = []

func _ready() -> void:
	# Create trail copies
	for i in range(3):
		var trail = duplicate() as Label
		trail.modulate.a = 0.3 - (i * 0.1)
		trail.z_index = -1
		get_parent().add_child(trail)
		_trail_nodes.append(trail)

	_play_animation()

func _process(_delta: float) -> void:
	# Update trail positions (slight delay effect)
	for i in range(_trail_nodes.size()):
		var delay_factor = (i + 1) * 0.05
		_trail_nodes[i].position = position + Vector2(0, delay_factor * 50)
		_trail_nodes[i].modulate.a = modulate.a * (0.3 - i * 0.1)
```

## Number Type Presets

### Damage Number
```
Color: Red (#dc2626)
Font Size: 20
Float Distance: 50
Duration: 1.0s
Outline: Black, 2px
```

### Critical Damage
```
Color: Yellow (#fbbf24)
Font Size: 30 (or 1.5x scale)
Float Distance: 60
Duration: 1.2s
Prefix: "CRIT! "
Additional: Screen shake (small)
```

### Healing Number
```
Color: Green (#22c55e)
Font Size: 20
Float Distance: 40
Duration: 0.9s
Prefix: "+"
```

### Blocked/Absorbed
```
Color: Gray (#9ca3af)
Font Size: 16
Float Distance: 30
Duration: 0.8s
Text: "BLOCKED" or "ABSORBED"
```

### Miss
```
Color: Light Gray (#d1d5db)
Font Size: 16
Float Distance: 25
Duration: 0.7s
Text: "MISS"
```

### Gold/Loot
```
Color: Gold (#fbbf24)
Font Size: 18
Float Distance: 45
Duration: 1.0s
Suffix: " gold"
```

### XP Gain
```
Color: Purple (#a855f7)
Font Size: 18
Float Distance: 50
Duration: 1.1s
Suffix: " XP"
```

### Level Up
```
Color: Gold with white glow
Font Size: 32
Float Distance: 80
Duration: 2.0s
Text: "LEVEL UP!"
Additional: Particle burst
```

## Color Reference

| Type | Color Hex | Color Name |
|------|-----------|------------|
| Damage | `#dc2626` | Red |
| Critical | `#fbbf24` | Yellow |
| Heal | `#22c55e` | Green |
| Shield/Block | `#3b82f6` | Blue |
| Miss | `#9ca3af` | Gray |
| Poison DoT | `#84cc16` | Lime |
| Fire DoT | `#ff6b35` | Orange |
| Gold | `#fbbf24` | Gold |
| XP | `#a855f7` | Purple |
| Mana | `#3b82f6` | Blue |
